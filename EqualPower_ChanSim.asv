N = 8;
P = [1 .8]
h = freqz(P,1);
n = N/2;
n_var = .181;    
gap = 1;

abs_H_n = abs(cat(1, h(1:length(h)/n:end), h(end)));

E_n = [1 2 2 2 1];
SNR_n = abs_H_n.^2.*E_n/n_var;
r_n = (log2(1+(SNR_